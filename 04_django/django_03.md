## Django 03



## Forms

> 1. data validation
> 2. html form ì‰½ê²Œ ë§Œë“¤ê¸°
>
> 
>
> django í”„ë¡œì íŠ¸ì˜ ì£¼ìš” ìœ íš¨ì„± ê²€ì‚¬ ë„êµ¬ë“¤ ì¤‘ í•˜ë‚˜
>
> ê³µê²© ë° ìš°ì—°í•œ ë°ì´í„° ì†ìƒ ë°©ì§€





1. ë Œë”ë§ì„ ìœ„í•œ ë°ì´í„° ì¤€ë¹„ ë° ì¬êµ¬ì„±
2. ë°ì´í„°ì— ëŒ€í•œ HTML forms ìƒì„±
3. í´ë¼ì´ì–¸íŠ¸ë¡œë¶€í„° ë°›ì€ ë°ì´í„° ìˆ˜ì‹  ë° ì²˜ë¦¬



### Form

> ëª¨ë¸ê³¼ ì—°ê²°ë˜ì§€ ì•Šì€ form



#### Form Class

- django Form ê´€ë¦¬ ì‹œìŠ¤í…œì˜ í•µì‹¬
- form ë‚´ field, field ë°°ì¹˜, ë””ìŠ¤í”Œë ˆì´ widget, label, ì´ˆê¸°ê°’, ìœ íš¨í•˜ì§€ ì•Šì€ field ì— ëŒ€í•œ ì—ëŸ¬ ë©”ì„¸ì§€ ê²°ì •
- ì‚¬ìš©ì ë°ì´í„° ë°›ì„ ë•Œ í•´ì•¼í•  ì‘ì—… (ë°ì´í„° ìœ íš¨ì„± ê²€ì¦, ê²€ì¦ ê²°ê³¼ ì¬ì¶œë ¥) ì²˜ë¦¬
- forms.py



#### forms.Form

![image-20210316143829234](django_03.assets/image-20210316143829234.png)

- Form fields ì§€ì •ì„ í†µí•´ ë‚˜ì¤‘ì— validate í•˜ê²Œ ëœë‹¤.
  - input ì— ëŒ€í•œ ìœ íš¨ì„± ê²€ì‚¬ ë¡œì§ì„ ì²˜ë¦¬í•˜ì—¬ í…œí”Œë¦¿ì—ì„œ ì§ì ‘ ì‚¬ìš©
  - model field ì— ëŒ€ì‘ ë˜ëŠ” form field
  - https://docs.djangoproject.com/en/3.1/topics/forms/modelforms/
- ë³€ìˆ˜ëª…ì´ input íƒœê·¸ì˜ nameì´ ëœë‹¤.
- widget ì‚¬ìš© 
  - HTML input ìš”ì†Œ ë Œë”ë§ ë° ì œì¶œ ëœ ì›ì‹œ ë°ì´í„° ì¶”ì¶œ ì²˜ë¦¬
  - ë°˜ë“œì‹œ form fields ì— í• ë‹¹ (ë…ìì  ì‚¬ìš© X)

![image-20210317090934956](django_03.assets/image-20210317090934956.png)



#### WidgetsğŸ€

- Form Fields ì™€ í˜¼ë™ë˜ì–´ì„œëŠ” ì•ˆ ë¨ (Form Fields ë‚´ë¶€ì—ì„œ ì‚¬ìš©)
- input element ì˜ ë‹¨ìˆœ raw í•œ ë Œë”ë§ ì²˜ë¦¬
- https://docs.djangoproject.com/en/3.1/ref/forms/widgets/



##### ì‚¬ìš©í•˜ê¸°

- multiple choices í•˜ëŠ” input íƒœê·¸ ë§Œë“¤ê¸°

![image-20210317095403447](django_03.assets/image-20210317095403447.png)



- input íƒœê·¸ì— ê°œë³„ ì†ì„±(attribute) ì£¼ê¸° (style)

![image-20210317093818450](django_03.assets/image-20210317093818450.png)



![image-20210316172943189](django_03.assets/image-20210316172943189.png)

![image-20210316143951682](django_03.assets/image-20210316143951682.png)

- `form.as_p`
- `form.as_table`
- `form.as_ul`



## ModelFormğŸ

> ëª¨ë¸ê³¼ ì—°ë™í•˜ì—¬ ì‚¬ìš©í•˜ëŠ” form
>
> modelì„ í†µí•´ Form Class ë¥¼ ë§Œë“¤ ìˆ˜ ìˆëŠ” Helper



#### Meta Class

- í•„ë“œ ì¬ì •ì˜ í•˜ëŠ” ëŒ€ì‹ ì— model ì„ ë“±ë¡í•œë‹¤.
- ëª¨ë¸ í´ë˜ìŠ¤ì— ëŒ€í•œ ì •ë³´ ì‘ì„±



![image-20210316163513955](django_03.assets/image-20210316163513955.png)

- django ê°€ ì œê³µí•˜ëŠ” Meta í´ë˜ìŠ¤
- model ë³€ìˆ˜
  - ì—°ë™í•  ëª¨ë¸ í´ë˜ìŠ¤ ì§€ì • 
  - ì‚¬ìš©í•˜ê¸° ìœ„í•´ì„œëŠ” import í•„ìˆ˜
- fields ë³€ìˆ˜
  - ì‚¬ìš©í•  í•„ë“œ ì§€ì •



#### ModelForm ë§¤ê°œë³€ìˆ˜ 

![image-20210316162001024](django_03.assets/image-20210316162001024.png)

- `data`ëŠ” `request`ì—ì„œ êº¼ë‚¸ dataë¡œ formì„ ì±„ìš´ë‹¤.

- `instance`ëŠ” ê°œë³„ ê°ì²´ë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë°›ì•„ì„œ formì„ ì±„ìš´ë‹¤.

  - í‚¤ì›Œë“œ ë³€ìˆ˜ë¡œ ì‚¬ìš©í•œë‹¤.
  



#### ì‚¬ìš©ì˜ˆì‹œ

![image-20210317100844710](django_03.assets/image-20210317100844710.png)





## Form & ModelForm

#### Form

- ì–´ë–¤ ëª¨ë¸ì— ì €ì¥í•´ì•¼ í•˜ëŠ”ì§€ ì•Œ ìˆ˜ ì—†ìœ¼ë¯€ë¡œ ìœ íš¨ì„± ê²€ì‚¬ ì´í›„
- cleaned_data ë”•ì…”ë„ˆë¦¬ ìƒì„±
- ë”•ì…”ë„ˆë¦¬ì—ì„œ ë°ì´í„°ë¥¼ ê°€ì ¸ì˜¨ í›„ save() í˜¸ì¶œ

![image-20210317092238687](django_03.assets/image-20210317092238687.png)



#### ModelForm

- djangoê°€ í•´ë‹¹ modelì—ì„œ ì–‘ì‹ì— í•„ìš”í•œ ëŒ€ë¶€ë¶„ì˜ ì •ë³´ë¥¼ ì´ë¯¸ ì •ì˜
- ì–´ë–¤ ë ˆì½”ë“œë¥¼ ë§Œë“¤ì–´ì•¼ í•  ì§€ ì•Œê³  ìˆìœ¼ë¯€ë¡œ ë°”ë¡œ .save() í˜¸ì¶œ ê°€ëŠ¥



## Create

##### * í•˜ë‚˜ì˜ URL ë¡œ ìš”ì²­(request)ì˜ ì¢…ë¥˜ì— ë”°ë¼ ë‹¤ë¥¸ ì¼ ì²˜ë¦¬í•˜ê¸°

![image-20210316173532901](django_03.assets/image-20210316173532901.png)



- POST ìš”ì²­ì´ ë“¤ì–´ì˜¬ ë•Œ,
  - ëª¨ë¸ê³¼ ì—°ë™ëœ Form í´ë˜ìŠ¤ë¥¼ init 
    - data = request.POST
  - `is_valid()` í•¨ìˆ˜ í†µí•˜ì—¬ ìœ íš¨ì„± ê²€ì‚¬
    - Boolean ê°’ ë°˜í™˜
  - save() ë¡œì§ ì‹¤í–‰
- GET ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ë•Œ,
  - ë¹„ì–´ìˆëŠ” Form ìƒì„±



## Update

![image-20210316173850840](django_03.assets/image-20210316173850840.png)



- get_object_or_404(Class, pk=pk)
  - pk ì´ë¦„ì„ êµ¬ì²´ì ìœ¼ë¡œ ì“´ ê²ƒì— ì£¼ì˜ (ì¶”í›„ ì´ë¦„ì´ ì¤‘ë³µë  ê²ƒì„ ëŒ€ë¹„í•œë‹¤)
  - ê°ì²´ê°€ ì¡´ì¬í•œë‹¤ë©´ ê°ì²´ë¥¼ ë°˜í™˜í•˜ê³  ì¡´ì¬í•˜ì§€ ì•ŠëŠ”ë‹¤ë©´ 404 ê²°ê³¼ ë°˜í™˜



##### createì™€ì˜ ì°¨ì´

```python
# POST ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ê²½ìš°, ìˆ˜ì •
form = ArticleForm(request.POST, instance = article)

# GET ìš”ì²­ì´ ë“¤ì–´ì™”ì„ ê²½ìš°, ìˆ˜ì • ì–‘ì‹ ì œê³µ
form = ArticleForm(instance = article)
```

- ê¸°ì¡´ì˜ ê°ì²´ë¥¼ ìˆ˜ì •í•˜ëŠ” ê²ƒì´ê¸° ë•Œë¬¸ì— ì°¸ì¡°í•  ê°ì²´ instanceë¥¼ ë§¤ê°œë³€ìˆ˜ë¡œ ë„˜ê¸´ë‹¤.
- instance ë¥¼ ì§€ì •í•˜ì§€ ì•Šìœ¼ë©´ save() í–ˆì„ ë•Œ createë¥¼ í•˜ê²Œëœë‹¤.



## Form rendering



### ê°œë³„ field ì¶”ì¶œí•˜ê¸°

![image-20210317094809182](django_03.assets/image-20210317094809182.png)



### for loop ì‚¬ìš©í•´ì„œ field ì“°ê¸°



![image-20210317100246453](django_03.assets/image-20210317100246453.png)



### Bootstrap ì ìš©í•˜ê¸°

#### í´ë˜ìŠ¤ ì ìš©í•˜ê¸°

![image-20210317101448320](django_03.assets/image-20210317101448320.png)



#### third party app ì„¤ì¹˜í•˜ì—¬ ë¼ì´ë¸ŒëŸ¬ë¦¬ ì‚¬ìš©í•˜ê¸°

- https://pypi.org/project/django-bootstrap-v5/
- https://django-bootstrap-v5.readthedocs.io/en/latest/quickstart.html



![image-20210317102255439](django_03.assets/image-20210317102255439.png)

![image-20210317102517260](django_03.assets/image-20210317102517260.png)

- load tag ì‚¬ìš© ì£¼ì˜



##### include tag

- ìœ ì§€ ë³´ìˆ˜ë¥¼ ìœ„í•´ ì‚¬ìš©í•œë‹¤.
- í…œí”Œë¦¿ ë‚´ì—ì„œ ë‹¤ë¥¸ í…œí”Œë¦¿ì„ í¬í•¨í•˜ëŠ” ë°©ë²•

![image-20210317103341099](django_03.assets/image-20210317103341099.png)



## Django View decorators



- ì–´ë–¤ í•¨ìˆ˜ì— ê¸°ëŠ¥ ì¶”ê°€ í•˜ê³ ì í•  ë•Œ í•´ë‹¹ í•¨ìˆ˜ë¥¼ ìˆ˜ì •í•˜ì§€ ì•Šê³  ê¸°ëŠ¥ì„ ì—°ì¥
- django ëŠ” ë‹¤ì–‘í•œ ê¸°ëŠ¥ ì§€ì›í•˜ê¸° ìœ„í•´ view í•¨ìˆ˜ì— ì ìš©í•  ìˆ˜ ìˆëŠ” ì—¬ëŸ¬ ë°ì½”ë ˆì´í„° ì œê³µ
- Allowed HTTP methods
  - ìš”ì²­ ë©”ì„œë“œì— ë”°ë¼ view í•¨ìˆ˜ì— ëŒ€í•œ ì—‘ì„¸ìŠ¤ë¥¼ ì œí•œ
  - ìš”ì²­ì´ ì¡°ê±´ì„ ì¶©ì¡±ì‹œí‚¤ì§€ ëª»í•˜ë©´ HttpResponseNotAllowed ì„ return
  - require_http_methods()
  - require_POST()
  - require_safe()



![image-20210317104319513](django_04.assets/image-20210317104319513.png)



##### postman

- method ë¥¼ ë³€ê²½í•´ djangoì— ìš”ì²­ì„ ë³´ë‚¼ ìˆ˜ ìˆë‹¤.